{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reading Homepage</title>
  {# 烦死了，bydCDN，byd傻逼墙 #}
  <link rel="stylesheet" href="https://cdn.staticfile.net/twitter-bootstrap/5.3.3/css/bootstrap.min.css">
  <script src="https://cdn.staticfile.net/popper.js/2.9.3/umd/popper.min.js"></script>
  <script src="https://cdn.staticfile.net/twitter-bootstrap/5.3.3/js/bootstrap.min.js"></script>
  <script src="{% static 'jquery-3.7.1.min.js' %}"></script>
  <script src="{% static 'js/breadcrumb.js' %}"></script>
  <script src="{% static 'js/edit_profile.js' %}"></script>
  <script src="{% static 'js/editor.js' %}"></script>
  <script src="{% static 'js/post_detail.js' %}"></script>
  <script src="{% static 'js/show_toast.js' %}"></script>
  <script src="{% static 'js/post_content_truncated.js' %}"></script>
  <script src="{% static 'js/check_login.js' %}"></script>
  <link rel="stylesheet" href="{% static 'css/breadcrumb_link.css' %}">
  <link rel="stylesheet" href="{% static 'css/base_forum.css' %}">
  <link rel="stylesheet" href="{% static 'css/userinfo.css' %}">
  <link rel="stylesheet" href="{% static 'css/userinfo_edit.css' %}">
  <link rel="stylesheet" href="{% static 'css/editor.css' %}">
  <link rel="stylesheet" href="{% static 'css/post_detail.css' %}">
  <link rel="stylesheet" href="{% static 'css/sort_button.css' %}">
  <link rel="stylesheet" href="{% static 'css/book_detail.css' %}">
  <link rel="stylesheet" href="{% static 'css/avatar_mini.css' %}">
  <link rel="stylesheet" href="{% static 'css/user_info_mini.css' %}">
  <link rel="stylesheet" href="{% static 'css/up_down.css' %}">{# 赞踩(上下箭头) #}
  <link rel="stylesheet" href="{% static 'css/comments.css' %}">
  <link rel="stylesheet" href="{% static 'css/module_block.css' %}">
  <link rel="stylesheet" href="{% static 'css/label.css' %}">
  <link rel="stylesheet" href="{% static 'css/content_truncated.css' %}">
  <link rel="stylesheet" href="{% static 'css/one_way_sort_btn.css' %}">
  <link rel="stylesheet" href="{% static 'css/reply.css' %}">
</head>
<body>
<div id="navbar-container">
  <nav class="navbar py-1 rounded border-bottom">
    <div class="container">
      <a class="navbar-brand" id="forum-title" href="{% url 'home' %}"><b>ReadingForum</b></a>
      <ul class="navbar-nav me-auto flex-row">
        <li class="nav-item"><a href="{% url 'home' %}" class="nav-link px-2">首页</a></li>
        <li class="nav-item"><a href="{% url 'book_list' %}" class="nav-link px-2">读书</a></li>
        <li class="nav-item"><a href="#" class="nav-link px-2">交流</a></li>
        <li class="nav-item"><a href="#" class="nav-link px-2">购书</a></li>
        <li class="nav-item"><a href="#" class="nav-link px-2">关于</a></li>
        {% if request.session.is_admin %}
          <li class="nav-item"><a href="{% url 'admin_index' %}" class="nav-link px-2">后台</a></li>
        {% endif %}
      </ul>
      {#  TODO 做一个搜索功能  #}
      <form role="search" action="" method="post">
        <input class="form-control" type="search" placeholder="搜索">
      </form>
      {% if request.session.username %}
        <div class="dropdown">
          <button type="button" class="btn dropdown-toggle" style="border: none" data-bs-toggle="dropdown" aria-expanded="false">
            <img id="avatar-mini"
                 src="{% if request.session.avatar_url %}{{ request.session.avatar_url }}{% else %}{% static 'img/default_avatar.svg' %}{% endif %}"
                 alt="用户头像">
            <span class="ms-2">{{ request.session.username }}</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" style="width: 60px">
            <li><a class="dropdown-item" href="{% url 'userinfo' request.session.username %}">个人中心</a></li>
            <li><a class="dropdown-item" href="{% url 'profile' %}">编辑资料</a></li>
            <li>
              <hr class="dropdown-divider">
            </li>
            {# TODO 消息通知 #}
            <li>
              <a class="dropdown-item d-flex align-items-center justify-content-between" href="#">消息 
                <span class="badge bg-danger">4</span>
              </a>
            </li>
            {# TODO 未定功能 #}
            <li><a class="dropdown-item" href="#">链接</a></li>
            <li>
              <hr class="dropdown-divider">
            </li>
            <li><a class="dropdown-item" href="{% url 'logout' %}">注销</a></li>
          </ul>
        </div>
      {% else %}
        {# 用户在哪里跳转到注册/登录页面，注册/登录完之后就跳转回原来的页面 #}
        <a href="{% url "login" %}?next={% firstof request.path "/" %}" class="nav-link px-3" id="navbar-login">登录</a>
        <a href="{% url 'register' %}?next={% firstof request.path "/" %}" class="nav-link px-3"
           id="navbar-register">注册</a>
      {% endif %}
    </div>
  </nav>
</div>
<div style="margin-top: 49px">
  {% block content %}
  {% endblock %}
</div>

<div id="toast-container" class="toast-container position-fixed bottom-0 end-0 p-3"></div>

<div class="container">
  <footer class="py-3 my-4 border-top border-info-subtle">
    <p class="text-center text-muted" style="font-size: 12px">© 反正又没人看</p>
  </footer>
</div>
</body>
</html>